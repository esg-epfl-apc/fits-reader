/*! For license information please see fits-reader.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FITSReader=e():t.FITSReader=e()}(this,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function o(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}t.r(e),t.d(e,{parseFITS:()=>wt});var i=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cardIndex=0,this.primary=e,this.extension=!1,this.extensionType=null},(e=[{key:"verifyOrder",value:function(t,e){e!==this.cardIndex&&console.warn("".concat(t," should appear at index ").concat(this.cardIndex," in the FITS header"))}},{key:"verifyBetween",value:function(t,e,r,n){if(!(e>=r&&e<=n))throw"The ".concat(t," value of ").concat(e," is not between ").concat(r," and ").concat(n)}},{key:"verifyBoolean",value:function(t){return"T"===t}},{key:"SIMPLE",value:function(t){return this.primary=!0,this.verifyOrder("SIMPLE",0),this.verifyBoolean(t)}},{key:"XTENSION",value:function(t){return console.log("EXTENSION TYPE HF"),console.log(t),this.extension=!0,this.extensionType=t,this.verifyOrder("XTENSION",0),this.extensionType}},{key:"BITPIX",value:function(t){var e="BITPIX";if(t=parseInt(t),this.verifyOrder(e,1),![8,16,32,-32,-64].includes(t))throw"".concat(e," value ").concat(t," is not permitted");return t}},{key:"NAXIS",value:function(t,e){var r="NAXIS";if(t=parseInt(t),!e&&(this.verifyOrder(r,2),this.verifyBetween(r,t,0,999),this.extension&&["TABLE","BINTABLE"].includes(this.extensionType))&&2!==t)throw"".concat(r," must be ").concat(2," for TABLE and BINTABLE extensions");return t}},{key:"PCOUNT",value:function(t){var e="PCOUNT";t=parseInt(t);var r=3+this.NAXIS();if(this.verifyOrder(e,r),this.extension&&["IMAGE","TABLE"].includes(this.extensionType)&&0!==t)throw"".concat(e," must be ").concat(0," for the ").concat(this.extensionType," extensions");return t}},{key:"GCOUNT",value:function(t){var e="GCOUNT";t=parseInt(t);var r=3+this.NAXIS()+1;if(this.verifyOrder(e,r),this.extension&&["IMAGE","TABLE","BINTABLE"].includes(this.extensionType)&&1!==t)throw"".concat(e," must be ").concat(1," for the ").concat(this.extensionType," extensions");return t}},{key:"EXTEND",value:function(t,e){if(!e)throw"EXTEND must only appear in the primary header";return this.verifyBoolean(t)}},{key:"BSCALE",value:function(t){return parseFloat(t)}},{key:"BZERO",value:function(t){return parseFloat(t)}},{key:"BLANK",value:function(t){return t=parseInt(t),this.get("BITPIX")>0||console.warn("BLANK is not to be used for BITPIX = ".concat(this.get("BITPIX"))),t}},{key:"DATAMIN",value:function(t){return parseFloat(t)}},{key:"DATAMAX",value:function(t){return parseFloat(t)}},{key:"EXTVER",value:function(t){return parseInt(t)}},{key:"EXTLEVEL",value:function(t){return parseInt(t)}},{key:"TFIELDS",value:function(t){return t=parseInt(t),this.verifyBetween("TFIELDS",t,0,999),t}},{key:"TBCOL",value:function(t,e){return t=parseInt(t),this.verifyBetween("TBCOL",e,0,this.get("TFIELDS")),t}},{key:"ZIMAGE",value:function(t){return this.verifyBoolean(t)}},{key:"ZCMPTYPE",value:function(t){if(!["GZIP_1","RICE_1","PLIO_1","HCOMPRESS_1"].includes(t))throw"ZCMPTYPE value ".concat(t," is not permitted");if("RICE_1"!==t)throw"Compress type ".concat(t," is not yet implement");return t}},{key:"ZBITPIX",value:function(t){if(t=parseInt(t),![8,16,32,64,-32,-64].includes(t))throw"ZBITPIX value ".concat(t," is not permitted");return t}},{key:"ZNAXIS",value:function(t,e){return t=parseInt(t),e||this.verifyBetween("ZNAXIS",t,0,999),t}},{key:"ZTILE",value:function(t){return parseInt(t)}},{key:"ZSIMPLE",value:function(t){return"T"===t}},{key:"ZPCOUNT",value:function(t){return parseInt(t)}},{key:"ZGCOUNT",value:function(t){return parseInt(t)}},{key:"ZDITHER0",value:function(t){return parseInt(t)}}])&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function f(t,e,r){return(e=l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}var y=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"arrayPattern",/(\D+)(\d+)/),f(this,"maxLines",600),this.headerVerify=r,this.supportedCards=null,this.primary=r.primary,this.extension=!this.primary,null!=r){var n=Object.getOwnPropertyNames(Object.getPrototypeOf(this.headerVerify));this.supportedCards=n.filter((function(t){return"function"==typeof r[t]}))}this.cards={},this.cards.COMMENT=[],this.cards.HISTORY=[],this.cardIndex=0,this.block=e,this.readBlock(e)},(e=[{key:"get",value:function(t){return this.contains(t)?this.cards[t].value:null}},{key:"set",value:function(t,e,r){return r=r||"",this.cards[t]={index:this.cardIndex,value:e,comment:r},this.cardIndex+=1}},{key:"contains",value:function(t){return this.cards.hasOwnProperty(t)}},{key:"readLine",value:function(t){var e,r,n,o;if(""!==(n=t.slice(0,8).trim())){if(r=t.slice(8,10),o=t.slice(10),"= "===r){var i=u(o.split(" /"),2);return o=i[0],e=i[1],"'"===(o=o.trim())[0]?o=o.slice(1,-1).trim():"T"!==o&&"F"!==o&&(o=parseFloat(o)),console.log("CARD value"),console.log(n+" "+o),o=this.validate(n,o),this.set(n,o,e)}"COMMENT"!==n&&"HISTORY"!==n||this.cards[n].push(o.trim())}}},{key:"validate",value:function(t,e){var r,n,o;if(n=null,r=t,o=this.arrayPattern.test(t)){var i=u(this.arrayPattern.exec(t).slice(1),2);r=i[0],n=i[1]}return r in this.supportedCards&&(e=this.headerVerify[r](e,o,n)),e}},{key:"readBlock",value:function(t){var e,r,n,o,i,a;for(a=[],e=r=0,i=(o=(o=t.length/80)<this.maxLines?o:this.maxLines)-1;0<=i?r<=i:r>=i;e=0<=i?++r:--r)n=t.slice(80*e,80*(e+1)),a.push(this.readLine(n));return a}},{key:"hasDataUnit",value:function(){return 0!==this.get("NAXIS")}},{key:"getDataLength",value:function(){var t,e,r,n;if(!this.hasDataUnit())return 0;for(r=[],t=e=1,n=this.get("NAXIS");1<=n?e<=n:e>=n;t=1<=n?++e:--e)r.push(this.get("NAXIS".concat(t)));return r.reduce((function(t,e){return t*e}))*Math.abs(this.get("BITPIX"))/8+this.get("PCOUNT")}},{key:"getDataType",value:function(){switch(console.log("Data type setup"),console.log(this.extensionType+"Extension type"),this.extensionType||(this.extensionType=null),console.log(this.cards.XTENSION+"Cards extension"),this.cards.XTENSION&&(console.log(this.cards.XTENSION.value),this.extensionType=this.cards.XTENSION.value),console.log(this.extensionType),this.extensionType){case"BINTABLE":return console.log("BINTABLE"),this.contains("ZIMAGE")?"CompressedImage":"BinaryTable";case"TABLE":return"Table";default:return this.hasDataUnit()?"Image":null}}},{key:"isPrimary",value:function(){return this.primary}},{key:"isExtension",value:function(){return this.extension}}])&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function v(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:e+""}var b=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=e,this.data=r},(e=[{key:"hasData",value:function(){return null!=this.data}}])&&p(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P(n.key),n)}}function O(t,e,r){return e=T(e),function(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],T(t).constructor):e.apply(t,r))}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(E=function(){return!!t})()}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function P(t){var e=function(t,e){if("object"!=w(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}var B,k,j,A=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=O(this,e),e.initializeSwapEndian(),r instanceof ArrayBuffer?n.buffer=r:n.blob=r,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(e,t),r=e,n=[{key:"initializeSwapEndian",value:function(){e.swapEndian[8]=e.swapEndian.B,e.swapEndian[16]=e.swapEndian.I,e.swapEndian[32]=e.swapEndian.J}}],null&&S(r.prototype,null),n&&S(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"invoke",value:function(t,e,r){var n;if(n=null!=(null!=e?e.context:void 0)?e.context:this,null!=t)return t.call(n,r,e)}}])&&m(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D(n.key),n)}}function C(t,e,r){return e=N(e),function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_()?Reflect.construct(e,r||[],N(t).constructor):e.apply(t,r))}function _(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_=function(){return!!t})()}function N(t){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},N(t)}function F(t,e){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},F(t,e)}function D(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}B=A,j={B:function(t){return t},I:function(t){return t<<8|t>>8},J:function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255}},(k=P(k="swapEndian"))in B?Object.defineProperty(B,k,{value:j,enumerable:!0,configurable:!0,writable:!0}):B[k]=j;var M=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){(e=D(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(n=C(this,e,[t,r]),"maxMemory",1048576),n.rowByteSize=t.get("NAXIS1"),n.rows=t.get("NAXIS2"),n.cols=t.get("TFIELDS"),n.length=n.rowByteSize*n.rows,n.heapLength=t.get("PCOUNT"),n.columns=n.getColumns(t),null!=n.buffer?(n.rowsInMemory=n._rowsInMemoryBuffer,n.heap=n.buffer.slice(n.length,n.length+n.heapLength)):(n.rowsInMemory=n._rowsInMemoryBlob,n.firstRowInBuffer=n.lastRowInBuffer=0,n.nRowsInBuffer=Math.floor(n.maxMemory/n.rowByteSize)),n.accessors=[],n.descriptors=[],n.elementByteLengths=[],n.setAccessors(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(e,t),r=e,n=[{key:"_rowsInMemoryBuffer",value:function(){return!0}},{key:"_rowsInMemoryBlob",value:function(t,e){return!(t<this.firstRowInBuffer||e>this.lastRowInBuffer)}},{key:"getColumns",value:function(t){var e,r,n,o,i;for(e=[],r=n=1,i=this.cols;1<=i?n<=i:n>=i;r=1<=i?++n:--n){if(o="TTYPE".concat(r),!t.contains(o))return null;e.push(t.get(o))}return e}},{key:"getColumn",value:function(t,e,r){var n,o,i,a,u,c,s,f,l,y,h=this;return null!=this.blob?(f=this.columns.indexOf(t),a=this.descriptors[f],n=this.accessors[f],this.elementByteLengths[f],u=0===(u=this.elementByteLengths.slice(0,f)).length?0:u.reduce((function(t,e){return t+e})),i=null!=this.typedArray[a]?new this.typedArray[a](this.rows):[],y=~~(this.maxMemory/this.rowByteSize),y=Math.min(y,this.rows),c=this.rows/y,l=Math.floor(c)===c?c:Math.floor(c)+1,s=0,f=0,o=function(t,r){var a,c,p,v;for(a=t.byteLength/h.rowByteSize,v=new DataView(t),c=u;a--;)i[s]=n(v,c)[0],s+=1,c+=h.rowByteSize;if(f+=1,l-=1)return p=f*y,h.getTableBuffer(p,y,o,r);h.invoke(e,r,i)},this.getTableBuffer(0,y,o,r)):(o=function(r,n){return i=r.map((function(e){return e[t]})),h.invoke(e,n,i)},this.getRows(0,this.rows,o,r))}},{key:"getTableBuffer",value:function(t,e,r,n){var o,i,a,u,c=this;return e=Math.min(this.rows-t,e),a=(o=t*this.rowByteSize)+e*this.rowByteSize,i=this.blob.slice(o,a),(u=new FileReader).row=t,u.number=e,u.onloadend=function(t){return c.invoke(r,n,t.target.result)},u.readAsArrayBuffer(i)}},{key:"getRows",value:function(t,e,r,n){var o,i,a,u,c,s,f=this;return this.rowsInMemory(t,t+e)?(null!=this.blob?a=this.buffer:(u=(o=t*this.rowByteSize)+e*this.rowByteSize,a=this.buffer.slice(o,u)),s=this._getRows(a,e),this.invoke(r,n,s),s):(u=(o=t*this.rowByteSize)+Math.max(this.nRowsInBuffer*this.rowByteSize,e*this.rowByteSize),i=this.blob.slice(o,u),(c=new FileReader).row=t,c.number=e,c.onloadend=function(o){var i;return i=o.target,f.buffer=i.result,f.firstRowInBuffer=f.lastRowInBuffer=i.row,f.lastRowInBuffer+=i.number,f.getRows(t,e,r,n)},c.readAsArrayBuffer(i))}}],n&&x(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(A);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z(n.key),n)}}function X(t,e,r){return e=G(e),function(t,e){if(e&&("object"===R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,H()?Reflect.construct(e,r||[],G(t).constructor):e.apply(t,r))}function H(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(H=function(){return!!t})()}function G(t){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},G(t)}function z(t,e){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},z(t,e)}function Z(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:e+""}var K=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return function(t,e,r){(e=Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(t=X(this,e,[].concat(n)),"dataAccessors",{A:function(t){return t.trim()},I:function(t){return parseInt(t)},F:function(t){return parseFloat(t)},E:function(t){return parseFloat(t)},D:function(t){return parseFloat(t)}}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e)}(e,t),r=e,n=[{key:"setAccessors",value:function(t){var e,r,n,o,i,a,u,c=this;for(i=/([AIFED])(\d+)\.*(\d+)*/,u=[],n=o=1,a=this.cols;1<=a?o<=a:o>=a;n=1<=a?++o:--o)r=t.get("TFORM".concat(n)),t.get("TTYPE".concat(n)),e=i.exec(r)[1],u.push(function(t){var e;return e=function(e){return c.dataAccessors[t](e)},c.accessors.push(e)}(e));return u}},{key:"_getRows",value:function(t){var e,r,n,o,i,a,u,c,s,f,l,y,h,p,v,b,d,m,g;for(y=t.byteLength/this.rowByteSize,r=new Uint8Array(t),d=[],i=u=0,p=y-1;0<=p?u<=p:u>=p;i=0<=p?++u:--u){for(o=(n=i*this.rowByteSize)+this.rowByteSize,f="",l=0,c=(m=r.subarray(n,o)).length;l<c;l++)g=m[l],f+=String.fromCharCode(g);for(f=f.trim().split(/\s+/),b={},a=h=0,s=(v=this.accessors).length;h<s;a=++h)e=v[a],g=f[a],b[this.columns[a]]=e(g);d.push(b)}return d}}],n&&U(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(M);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function V(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rt(n.key),n)}}function $(t,e,r){return e=q(e),function(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Q()?Reflect.construct(e,r||[],q(t).constructor):e.apply(t,r))}function Q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Q=function(){return!!t})()}function q(t){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},q(t)}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t,e,r){return(e=rt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rt(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}var nt=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return et(t=$(this,e,[].concat(n)),"typedArray",{B:Uint8Array,I:Uint16Array,J:Uint32Array,E:Float32Array,D:Float64Array,1:Uint8Array,2:Uint16Array,4:Uint32Array}),et(t,"dataAccessors",{L:function(t,e){return[84===t.getInt8(e),e+=1]},B:function(t,e){return[t.getUint8(e),e+=1]},I:function(t,e){return[t.getInt16(e),e+=2]},J:function(t,e){return[t.getInt32(e),e+=4]},K:function(t,e){var r,n;return r=Math.abs(t.getInt32(e)),e+=4,[((n=r%10)?-1:1)*((r-=n)<<32|Math.abs(t.getInt32(e))),e+=4]},A:function(t,e){var r;return r=t.getUint8(e),[r=String.fromCharCode(r),e+=1]},E:function(t,e){return[t.getFloat32(e),e+=4]},D:function(t,e){return[t.getFloat64(e),e+=8]},C:function(t,e){var r;return r=t.getFloat32(e),e+=4,[[r,t.getFloat32(e)],e+=4]},M:function(t,e){var r;return r=t.getFloat64(e),e+=8,[[r,t.getFloat64(e)],e+=8]}}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(e,t),r=e,n=[{key:"toBits",value:function(t){var e,r;for(e=[],r=128;r>=1;)e.push(t&r?1:0),r/=2;return e}},{key:"getFromHeap",value:function(t,e,r){var n,o,i,a,u;for(u=t.getInt32(e),e+=4,o=t.getInt32(e),e+=4,i=this.heap.slice(o,o+u),a=(n=new this.typedArray[r](i)).length;a--;)n[a]=this.constructor.swapEndian[r](n[a]);return[n,e]}},{key:"setAccessors",value:function(t){var r,n,o,i,a,u,c,s,f,l,y,h=this;for(s=/(\d*)([P|Q]*)([L|X|B|I|J|K|A|E|D|C|M]{1})/,l=[],i=u=1,f=this.cols;1<=f?u<=f:u>=f;i=1<=f?++u:--u)o=t.get("TFORM".concat(i)),y=t.get("TTYPE".concat(i)),c=s.exec(o),r=parseInt(c[1])||1,a=c[2],n=c[3],l.push(function(t,r){var n,o;if(h.descriptors.push(t),h.elementByteLengths.push(e.offsets[t]*r),a)switch(y){case"COMPRESSED_DATA":n=function(e,r){var n,o,i=V(h.getFromHeap(e,r,t),2);return n=i[0],r=i[1],o=new h.typedArray[h.algorithmParameters.BYTEPIX](h.ztile[0]),Decompress.Rice(n,h.algorithmParameters.BLOCKSIZE,h.algorithmParameters.BYTEPIX,o,h.ztile[0],Decompress.RiceSetup),[o,r]};break;case"GZIP_COMPRESSED_DATA":n=function(t,e){var r;for(r=new Float32Array(h.width),i=r.length;i--;)r[i]=NaN;return[r,e]};break;default:n=function(e,r){return h.getFromHeap(e,r,t)}}else 1===r?n=function(e,r){var n=V(h.dataAccessors[t](e,r),2);return[n[0],r=n[1]]}:"X"===t?(o=Math.log(r)/Math.log(2),n=function(t,e){var n,i,a,u,c,s,f;for(a=t.buffer.slice(e,e+o),i=[],f=0,s=(c=new Uint8Array(a)).length;f<s;f++)u=c[f],n=h.toBits(u),i=i.concat(n);return e+=o,[i.slice(0,+(r-1)+1||9e9),e]}):n="A"===t?function(t,e){var n,o,i,a,u,c;for(o=t.buffer.slice(e,e+r),u="",a=0,i=(n=new Uint8Array(o)).length;a<i;a++)c=n[a],u+=String.fromCharCode(c);return[u=u.trim(),e+=r]}:function(e,n){var o,a;for(i=r,o=[];i--;){var u=V(h.dataAccessors[t](e,n),2);a=u[0],n=u[1],o.push(a)}return[o,n]};return h.accessors.push(n)}(n,r));return l}},{key:"_getRows",value:function(t,e){var r,n,o,i,a,u,c,s,f;for(f=new DataView(t),i=0,c=[];e--;){for(u={},r=n=0,o=(a=this.accessors).length;n<o;r=++n){var l=V((0,a[r])(f,i),2);s=l[0],i=l[1],u[this.columns[r]]=s}c.push(u)}return c}}],n&&W(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(M);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(){it=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),u=new A(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var y="suspendedStart",h="suspendedYield",p="executing",v="completed",b={};function d(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(L([])));O&&O!==r&&n.call(O,a)&&(w=O);var E=g.prototype=d.prototype=Object.create(w);function T(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function r(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==ot(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=y;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=B(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function B(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,B(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ot(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},T(I.prototype),s(I.prototype,u,(function(){return this})),e.AsyncIterator=I,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new I(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function at(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function ct(t,e,r){return(e=st(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function st(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:e+""}et(nt,"offsets",{L:1,B:1,I:2,J:4,K:8,A:1,E:4,D:8,C:8,M:16});var ft=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,"LINEWIDTH",80),ct(this,"BLOCKLENGTH",2880),ct(this,"hdus",[]),this.arrayBuffer=e,this.fitsFile=r,this.file=null,this.length=null,this.primary=!0,this.blockCount=0,this.begin=0,this.end=this.BLOCKLENGTH,this.offset=0,this.headerStorage=new Uint8Array},e=[{key:"parseFileFromBuffer",value:function(){var t;if(this.file=this.arrayBuffer,this.length=this.file.byteLength,t=this.file.slice(this.begin+this.offset,this.end+this.offset),this.readBlock(t))return this.fitsFile;throw new Error("Error parsing the file")}},{key:"getFileAsync",value:(r=it().mark((function t(){var e,r;return it().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(this.file_path);case 3:return e=t.sent,t.next=6,e.arrayBuffer();case 6:return r=t.sent,t.next=9,this.getFile(r);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}}),t,this,[[0,11]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){at(i,n,o,a,u,"next",t)}function u(t){at(i,n,o,a,u,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"getFile",value:function(){var t=this;return fetch(this.file_path).then((function(t){if(!t.ok)throw new Error("HTTP error, status = ".concat(t.status));return t.arrayBuffer()})).then((function(e){return t.parseFile(e)}))}},{key:"parseFile",value:function(t){this.file=t,console.log(this.file),this.length=this.file.byteLength,this.readFromBuffer()}},{key:"readFromBuffer",value:function(){var t;return t=this.file.slice(this.begin+this.offset,this.end+this.offset),this.readBlock(t)}},{key:"readFromFile",value:function(){var t,e=this;return this.reader=new FileReader,this.reader.onloadend=function(t){return e.readBlock(t.target.result)},t=this.file.slice(this.begin+this.offset,this.end+this.offset),this.reader.readAsArrayBuffer(t)}},{key:"readBlock",value:function(t){var e,r,n,o,a,u,c,s,f,l,h,p,v;for(e=new Uint8Array(t),p=new Uint8Array(this.headerStorage),this.headerStorage=new Uint8Array(this.end),this.headerStorage.set(p,0),this.headerStorage.set(e,this.begin),f=this.BLOCKLENGTH/this.LINEWIDTH;f--;)if(32!==e[s=f*this.LINEWIDTH]){if(69===e[s]&&78===e[s+1]&&68===e[s+2]&&32===e[s+3]){for(l="",a=0,u=(c=this.headerStorage).length;a<u;a++)v=c[a],l+=String.fromCharCode(v);return o=new y(l,new i(this.primary)),!0===this.primary&&(this.primary=!1),this.start=this.end+this.offset,r=o.getDataLength(),h=this.file.slice(this.start,this.start+r),o.hasDataUnit()&&(n=this.createDataUnit(o,h)),this.hdus.push(new b(o,n)),this.fitsFile.addHDU(new b(o,n)),this.offset+=this.end+r+this.excessBytes(r),this.offset===this.length?(console.log("parsing complete parser"),this.headerStorage=null,!!this.fitsFile.isValid()&&(console.log("fits file"),!0)):(this.blockCount=0,this.begin=this.blockCount*this.BLOCKLENGTH,this.end=this.begin+this.BLOCKLENGTH,this.headerStorage=new Uint8Array,t=this.file.slice(this.begin+this.offset,this.end+this.offset),console.log("block"),this.readBlock(t))}break}return this.blockCount+=1,this.begin=this.blockCount*this.BLOCKLENGTH,this.end=this.begin+this.BLOCKLENGTH,t=this.file.slice(this.begin+this.offset,this.end+this.offset),this.readBlock(t)}},{key:"_readBlockFromBuffer",value:function(t){return this.readBlock(t)}},{key:"_readBlockFromFile",value:function(t){return this.reader.readAsArrayBuffer(t)}},{key:"createDataUnit",value:function(t,e){var r,n=null;switch(console.log("Creating data unit"),r=t.getDataType(),console.log(r+" Data type"),r){case"BinaryTable":n=new nt(t,e);break;case"Table":n=new K(t,e);break;default:n=new Image(t,e)}return n}},{key:"excessBytes",value:function(t){return(this.BLOCKLENGTH-t%this.BLOCKLENGTH)%this.BLOCKLENGTH}},{key:"isEOF",value:function(){return this.offset===this.length}}],e&&ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t,e){if("object"!=lt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lt(e)?e:e+""}var pt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,r){(e=ht(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(this,"hdus",[])},(e=[{key:"addHDU",value:function(t){this.hdus.push(t)}},{key:"isValid",value:function(){return!0}},{key:"getHDU",value:function(t){var e,r,n,o;if(console.log("hdus"),console.log(this),console.log(this.hdus),console.log(this.hdus[1]),console.log("hdus"),null!=t&&null!=this.hdus[t])return console.log("hdu"),this.hdus[t];for(console.log("AAAAA"),r=0,n=(o=this.hdus).length;r<n;r++)if(e=o[r],console.log(e),e.hasData())return e}},{key:"getHeader",value:function(t){return this.getHDU(t).header}},{key:"getDataUnit",value:function(t){return this.getHDU(t).data}}])&&yt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mt(n.key),n)}}function dt(t,e,r){return(e=mt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mt(t){var e=function(t,e){if("object"!=vt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vt(e)?e:e+""}var gt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),dt(this,"array_buffer",null),dt(this,"parser",null),this.array_buffer=e,this.parser=new ft(e,new pt)},(e=[{key:"parseFile",value:function(){return this.parser.parseFileFromBuffer(this.array_buffer)}}])&&bt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function wt(t){return new gt(t).parseFile()}return e})()));